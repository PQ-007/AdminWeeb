{
  "version": 3,
  "sources": ["../../@umijs/use-params/es/index.js", "../../omit.js/es/index.js"],
  "sourcesContent": ["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n/* eslint-disable no-restricted-syntax */\r\nimport { useEffect, useMemo, useState } from 'react';\r\n/**\r\n *\r\n * @param {object} params\r\n * @returns {URL}\r\n */\r\nfunction setQueryToCurrentUrl(params) {\r\n    var _a;\r\n    var URL = (typeof window !== 'undefined' ? window : {}).URL;\r\n    var url = new URL((_a = window === null || window === void 0 ? void 0 : window.location) === null || _a === void 0 ? void 0 : _a.href);\r\n    Object.keys(params).forEach(function (key) {\r\n        var value = params[key];\r\n        if (value !== null && value !== undefined) {\r\n            if (Array.isArray(value)) {\r\n                url.searchParams.delete(key);\r\n                value.forEach(function (valueItem) {\r\n                    url.searchParams.append(key, valueItem);\r\n                });\r\n            }\r\n            else if (value instanceof Date) {\r\n                if (!Number.isNaN(value.getTime())) {\r\n                    url.searchParams.set(key, value.toISOString());\r\n                }\r\n            }\r\n            else if (typeof value === 'object') {\r\n                url.searchParams.set(key, JSON.stringify(value));\r\n            }\r\n            else {\r\n                url.searchParams.set(key, value);\r\n            }\r\n        }\r\n        else {\r\n            url.searchParams.delete(key);\r\n        }\r\n    });\r\n    return url;\r\n}\r\nexport function useUrlSearchParams(initial, config) {\r\n    var _a;\r\n    if (initial === void 0) { initial = {}; }\r\n    if (config === void 0) { config = { disabled: false }; }\r\n    /**\r\n     * The main idea of this hook is to make things response to change of `window.location.search`,\r\n     * so no need for introducing new state (in the mean time).\r\n     * Whenever `window.location.search` is changed but  not cause re-render, call `forceUpdate()`.\r\n     * Whenever the component - user of this hook - re-render, this hook should return\r\n     * the query object that corresponse to the current `window.location.search`\r\n     */\r\n    var _b = useState(), forceUpdate = _b[1];\r\n    var locationSearch = typeof window !== 'undefined' && ((_a = window === null || window === void 0 ? void 0 : window.location) === null || _a === void 0 ? void 0 : _a.search);\r\n    /**\r\n     * @type {URLSearchParams}\r\n     */\r\n    var urlSearchParams = useMemo(function () {\r\n        if (config.disabled)\r\n            return {};\r\n        return new URLSearchParams(locationSearch || {});\r\n    }, [config.disabled, locationSearch]);\r\n    var params = useMemo(function () {\r\n        if (config.disabled)\r\n            return {};\r\n        if (typeof window === 'undefined' || !window.URL)\r\n            return {};\r\n        var result = [];\r\n        // @ts-ignore\r\n        urlSearchParams.forEach(function (value, key) {\r\n            result.push({\r\n                key: key,\r\n                value: value,\r\n            });\r\n        });\r\n        // group by key\r\n        result = result.reduce(function (acc, val) {\r\n            (acc[val.key] = acc[val.key] || []).push(val);\r\n            return acc;\r\n        }, {});\r\n        result = Object.keys(result).map(function (key) {\r\n            var valueGroup = result[key];\r\n            if (valueGroup.length === 1) {\r\n                return [key, valueGroup[0].value];\r\n            }\r\n            return [key, valueGroup.map(function (_a) {\r\n                    var value = _a.value;\r\n                    return value;\r\n                })];\r\n        });\r\n        var newParams = __assign({}, initial);\r\n        result.forEach(function (_a) {\r\n            var key = _a[0], value = _a[1];\r\n            newParams[key] = parseValue(key, value, {}, initial);\r\n        });\r\n        return newParams;\r\n    }, [config.disabled, initial, urlSearchParams]);\r\n    function redirectToNewSearchParams(newParams) {\r\n        if (typeof window === 'undefined' || !window.URL)\r\n            return;\r\n        var url = setQueryToCurrentUrl(newParams);\r\n        if (window.location.search !== url.search) {\r\n            window.history.replaceState({}, '', url.toString());\r\n        }\r\n        if (urlSearchParams.toString() !== url.searchParams.toString()) {\r\n            forceUpdate({});\r\n        }\r\n    }\r\n    useEffect(function () {\r\n        if (config.disabled)\r\n            return;\r\n        if (typeof window === 'undefined' || !window.URL)\r\n            return;\r\n        redirectToNewSearchParams(__assign(__assign({}, initial), params));\r\n    }, [config.disabled, params]);\r\n    var setParams = function (newParams) {\r\n        redirectToNewSearchParams(newParams);\r\n    };\r\n    useEffect(function () {\r\n        if (config.disabled)\r\n            return function () { };\r\n        if (typeof window === 'undefined' || !window.URL)\r\n            return function () { };\r\n        var onPopState = function () {\r\n            forceUpdate({});\r\n        };\r\n        window.addEventListener('popstate', onPopState);\r\n        return function () {\r\n            window.removeEventListener('popstate', onPopState);\r\n        };\r\n    }, [config.disabled]);\r\n    return [params, setParams];\r\n}\r\nvar booleanValues = {\r\n    true: true,\r\n    false: false,\r\n};\r\nfunction parseValue(key, _value, types, defaultParams) {\r\n    if (!types)\r\n        return _value;\r\n    var type = types[key];\r\n    var value = _value === undefined ? defaultParams[key] : _value;\r\n    if (type === Number) {\r\n        return Number(value);\r\n    }\r\n    if (type === Boolean || _value === 'true' || _value === 'false') {\r\n        return booleanValues[value];\r\n    }\r\n    if (Array.isArray(type)) {\r\n        // eslint-disable-next-line eqeqeq\r\n        return type.find(function (item) { return item == value; }) || defaultParams[key];\r\n    }\r\n    return value;\r\n}\r\n", "function omit(obj, fields) {\n  // eslint-disable-next-line prefer-object-spread\n  var shallowCopy = Object.assign({}, obj);\n\n  for (var i = 0; i < fields.length; i += 1) {\n    var key = fields[i];\n    delete shallowCopy[key];\n  }\n\n  return shallowCopy;\n}\n\nexport default omit;"],
  "mappings": "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",
  "names": ["_a"]
}
